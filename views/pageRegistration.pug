extends layout

block head
    title="Финансовый Когресс Банка России:  Регистрация"
block content
    include elems/internalHead
    .tower#registration
        .subTower
            .partnersDecor
                include svg/regDecor.svg
            if typeid==4
                .sectionTitle Аккредитация
            else
                .sectionTitle Заявка на участие
            .regBox
                .menuItem.flex.center.left.mt-4
                    .menuItemBox
                    if typeid==4
                        .menuItemText Сотрудник СМИ
                    else
                        .menuItemText Участник
                .regRow
                    .reqPhoto2.reg287(v-on:click="uploadPhoto()" v-bind:class="{errorPhoto:photoError}")
                        .reqPhotoBox2
                            .reqPhotoBox2Photo
                                img(v-if="user.photoid" :src="'/static/image/middle/'+user.photoid")
                                #noFoto(v-else)
                                    div Загрузить фото<br>для аккредитации
                        .reqRowErrorMessage(v-if="photoError") Фотография должна быть загружена

                //.regRow
                    .reqPhoto.reg287(v-on:click="uploadPhoto()" v-bind:class="{errorPhoto:photoError}")
                        .reqPhotoBox
                            img(v-if="user.photoid" :src="'/static/image/middle/'+user.photoid")
                            #noFoto(v-else)
                                div Загрузить фото<br>для аккредитации

                                //.photoLoader(v-if="photoIsLoading")
                                        include svg/loader.svg
                    .reqRowErrorMessage(v-if="photoError") Фотография должна быть загружена

                .regRow(v-bind:class="{error:errors.f}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 Фамилия
                        input.reqInput(v-model="user.f" must name="f")
                .regRow(v-bind:class="{error:errors.i}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 Имя
                        input.reqInput(v-model="user.i" must name="i")
                .regRow(v-bind:class="{error:errors.o}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 Отчество
                        input.reqInput(v-model="user.o" must name="o")
                .regRow(v-bind:class="{error:errors.passportNumber}")
                    .regRowGroup.flex.left
                        .recLabel.reg287  Серия и номер паспорта
                        input.reqInput(v-model="user.passportNumber" must name="passportNumber" placeholder="ФОРМАТ: С ПРОБЕЛОМ, КАК В ДОКУМЕНТЕ")
                .regRow(v-bind:class="{error:errors.passportDate}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 дата выдачи
                        input.reqInput(v-model="user.passportDate" must name="passportDate" placeholder="ФОРМАТ: КАК В ДОКУМЕНТЕ")
                .regRow(v-bind:class="{error:errors.passportCode}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 код подразделения
                        input.reqInput(v-model="user.passportCode" must name="passportCode" placeholder="ФОРМАТ: КАК В ДОКУМЕНТЕ")
                .regRow(v-bind:class="{error:errors.address}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 адрес регистрации
                        input.reqInput(v-model="user.address" must name="address" placeholder="ФОРМАТ: КАК В ДОКУМЕНТЕ")
                .regRow(v-bind:class="{error:errors.email}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 email
                        input.reqInput(v-model="user.email" must name="email" email )
                .regRow(v-bind:class="{error:errors.phone}")
                    .regRowGroup.flex.left
                        .recLabel.reg287 телефон
                        input.reqInput(v-model="user.phone" must name="phone" placeholder="ФОРМАТ: +7 000 000 0000")
                if !typeid && typeid!=4
                    .regRow
                        .regCheckBox.flex.left(v-bind:class="{active:user.isProxy}" v-on:click="user.isProxy=!user.isProxy")
                            div
                                .regCheckBoxBox
                            div
                                .regCheckBoxText есть Контактное лицо

                    .regIsProxy(v-if="user.isProxy")
                        .regRow(v-bind:class="{error:errors.proxyi}")
                            .regRowGroup.flex.left
                                .recLabel.reg287 Имя
                                input.reqInput(v-model="user.proxyi" must name="proxyi")
                        .regRow(v-bind:class="{error:errors.proxyemail}")
                            .regRowGroup.flex.left
                                .recLabel.reg287 email
                                input.reqInput(v-model="user.proxyemail" must email name="proxyemail")
                        .regRow(v-bind:class="{error:errors.proxyphone}")
                            .regRowGroup.flex.left
                                .recLabel.reg287 телефон
                                input.reqInput(v-model="user.proxyphone" must name="proxyphone" placeholder="ФОРМАТ: +7 000 000 0000" )
                if !typeid && typeid!=4
                    .regRow.topdivaider &nbsp;
                else
                    .regRow &nbsp;
                .regRow
                    .menuItem.flex.center.left
                        .menuItemBox
                        if typeid==4
                            .menuItemText СМИ, которое вы&nbsp;представляете
                        else
                            .menuItemText Компания, которую вы&nbsp;представляете
                .regRow(v-bind:class="{error:errors.company.inn}")
                    .regRowGroup.flex.left()
                        .recLabel.reg287 ИНН
                        input#inn.reqInput(v-on:change="if(innStatus.state==2) clear('company')" v-model="user.company.inn"  type="number")
                    .reqRowErrorMessage(v-if="innStatus.message") {{innStatus.message}}

                    .regCheckBox.green.flex.mobileWrap.left(v-on:click="loadInn('company', innStatus)" v-bind:class="{active:innStatus.state==2,loading:innStatus.state==1}" style="margin-top: 6px;" )
                        .regCheckBoxText(style="margin-left:0") <span class="innBtn">Загрузить из ФНС </span>
                        .regCheckBoxBox.desktop.opacity0(v-bind:class="{opacity100:innStatus.state==1}")
                            .FNSloader
                                include svg/loader.svg
                        //if typeid==4
                        //    .regCheckBoxComment Нажмите «Загрузить из ФНС», чтобы автоматически заполнить остальные реквизиты

                        .regCheckBoxComment Нажмите «Загрузить из ФНС», чтобы автоматически заполнить остальные реквизиты
                        .FNSloader.mobile.opacity0(v-bind:class="{opacity100:innStatus.state==1}")
                            include svg/loader.svg

                .regRow
                    .regRowGroup.readonly.flex.left
                        .recLabel.reg287 Наименование
                        input.reqInput( readonly v-model="user.company.name")
                .regRow
                    .regRowGroup.readonly.flex.left
                        .recLabel.reg287 КПП
                        input.reqInput(readonly v-model="user.company.kpp")
                .regRow
                    .regRowGroup.readonly.flex.left
                        .recLabel.reg287 ОГРН
                        input.reqInput(readonly v-model="user.company.ogrn")
                .regRow
                    .regRowGroup.readonly.flex.left
                        .recLabel.reg287 адрес
                        input.reqInput(readonly v-model="user.company.address")
                .regRow
                    .regRowGroup.readonly.flex.left
                        .recLabel.reg287 руководитель
                        input.reqInput(readonly v-model="user.company.director")
                .regRow
                    .regRowGroup.flex.left
                        .recLabel.reg287 телефон
                        input.reqInput( v-model="user.company.phone" placeholder="ФОРМАТ: +7 000 000 0000")
                .regRow
                    .regRowGroup.flex.left
                        if typeid==4
                            .recLabel.reg287  Название издания
                        else
                            .recLabel.reg287  Короткое наименование
                        input.reqInput( v-model="user.company.shortName" )
                //.regRow
                    .regRowGroup.flex.left
                        .recLabel.reg287 кто подписывает
                        input.reqInput( v-model="user.company.signater")
                //.regRow
                    .regCheckBox.green.flex.left(v-on:click="changeEdo()" v-bind:class="{active:user.company.isEdo}")
                        .regCheckBoxBox
                        .regCheckBoxText использует ЭДО
                //.regRow.divaider
                    span &nbsp;
                //.reqRow
                    .menuItem.flex.center.left.mt-4
                        .menuItemBox
                        .menuItemText плательщик&nbsp;<span class="gray">(отметьте нужный пункт)</span>
                //.regRow
                    .regCheckBox.flex.left(v-on:click="user.isPaySelf=false;isPayCompany=false" v-bind:class="{active:!isPayCompany && !user.isPaySelf}")
                        .regCheckBoxBox
                        .regCheckBoxText оплачивает компания, которую представляю
                //.regRow
                    .regCheckBox.flex.left(v-on:click="if(!user.isPaySelf) {user.isPaySelf=true;isPayCompany=false}" v-bind:class="{active:user.isPaySelf}" )
                        .regCheckBoxBox
                        .regCheckBoxText оплачиваю как физическое лицо

                //.regRow
                    .regCheckBox.flex.left(v-on:click="if(!isPayCompany) {user.isPaySelf=false;isPayCompany=true;}" v-bind:class="{active:isPayCompany}")
                        .regCheckBoxBox
                        .regCheckBoxText оплачивает другая компания
                //.regProxyGroup(v-if="isPayCompany")
                    .regRow(v-bind:class="{error:errors.payCompany.inn}")
                        .regRowGroup.flex.left(v-bind:class="{readonly:innPayStatus.isInnReadony}")
                            .recLabel.reg287 ИНН плательщика
                            input#payInn.reqInput(v-on:change="if(innPayStatus.state==2) clear('payCompany')" v-model="user.payCompany.inn"  type="number")
                        .reqRowErrorMessage(v-if="innPayStatus.message") {{innPayStatus.message}}
                        .regCheckBox.flex.left(v-on:click="loadInn('payCompany', innPayStatus, 'payInn')" v-bind:class="{active:innPayStatus.state==2,loading:innPayStatus.state==1}" style="margin-top: 6px;")
                            .regCheckBoxText(style="margin-left:0") <span class="innBtn">Загрузить из ФНС </span>
                            .regCheckBoxBox(v-if="innPayStatus.state==1")
                                div()
                                    include svg/loader.svg

                    .regRow
                        .regRowGroup.readonly.flex.left
                            .recLabel.reg287 Название
                            input.reqInput(readonly v-model="user.payCompany.name")
                    .regRow
                        .regRowGroup.readonly.flex.left
                            .recLabel.reg287 КПП
                            input.reqInput(readonly v-model="user.payCompany.kpp")
                    .regRow
                        .regRowGroup.readonly.flex.left
                            .recLabel.reg287 ОГРН
                            input.reqInput(readonly v-model="user.payCompany.ogrn")
                    .regRow
                        .regRowGroup.readonly.flex.left
                            .recLabel.reg287 адрес
                            input.reqInput(readonly v-model="user.payCompany.address")
                    .regRow
                        .regRowGroup.readonly.flex.left
                            .recLabel.reg287 руководитель
                            input.reqInput(readonly v-model="user.payCompany.director")
                    .regRow
                        .regRowGroup.readonly.flex.left
                            .recLabel.reg287 телефон
                            input.reqInput(readonly v-model="user.payCompany.phone")
                    .regRow
                        .regRowGroup.flex.left
                            .recLabel.reg287 короткое название
                            input.reqInput(v-model="user.payCompany.shortName")
                    //.regRow
                        .regRowGroup.flex.left
                            .recLabel.reg287 кто подписывает
                            input.reqInput(v-model="user.payCompany.signater")

                .regRow &nbsp;

                .regRow.checkBox
                    .regCheckBox.green.flex.left(v-on:click="user.isPersonalAgreement=!user.isPersonalAgreement" v-bind:class="{active:user.isPersonalAgreement}")
                        div
                            .regCheckBoxBox
                        div
                            .regCheckBoxText( ) ПРИНИМАЮ ПОЛЬЗОВАТЕЛЬСКОЕ СОГЛАШЕНИЕ
                                a.gray(onclick="event.preventDefault();window.open('/static/key/agr"+lang+"?open=open')")  (посмотреть)
                    .reqRowErrorMessage(v-if="isPersonalAgreementError && !user.isPersonalAgreement") Cоглашение не принято
                .regRow.checkBox
                    .regCheckBox.green.flex.left(v-on:click="user.isTerms=!user.isTerms" v-bind:class="{active:user.isTerms}")
                        div
                            .regCheckBoxBox
                        div
                            .regCheckBoxText СОГЛАШАЮСЬ НА ОБРАБОТКУ ПЕРСОНАЛЬНЫХ ДАННЫХ
                                a.gray(   onclick="event.preventDefault();window.open('/static/key/pers"+lang+"?open=open')")  (посмотреть)
                    .reqRowErrorMessage(v-if="isTermsError && !user.isTerms") Cоглашение не принято

                .regRow.desktop &nbsp;
                .regRow &nbsp;

                .regRow(v-if="isLodinng")
                    .regSubmit()
                        include svg/loader.svg
                .regRow(v-else)

                    .regSubmit(v-on:click="regUser()" v-if="!isRegSuccess") подать заявку
                    .regSuccess.flex.left(v-else)
                        .regCheckBox.success.flex.left()
                            .regCheckBoxBox
                                include svg/acceptGreen.svg
                            .regCheckBoxText ваша заявка успешно отправлена
                        .regSubmit(v-on:click="document.location.reload()" ) Создать новую заявку

    include elems/footer
    include elems/mobileMenu
    link(rel='stylesheet', href='/static/lib/cropper.min.css')
    script(src="https://code.iconify.design/iconify-icon/1.0.2/iconify-icon.min.js")
    script.

        let apiUrl = !{JSON.stringify(apiUrl)}
        let frontUrl = !{JSON.stringify(apiUrl)}
    if typeid == 4
        script.
            let type=4
    script(src="/static/javascripts/utils.js")
    script(src="/static/javascripts/mainScript.js")
    script(src="/static/lib/vue.min.js")
    script(src="/static/lib/cropper.min.js")
    script(src="/static/javascripts/regScript.js")
